<div class="row" style="border-bottom:solid 1px #e8e8e8;">  
    <div class="row">
        <h3 style="padding-left:5px;">Qc Test Lab</h3>
    </div>
</div>

<div class="row">
    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2  col-search">
        <div class="input-group">
            <div class="input-group-addon">From STS_NO</div>
            <input type="text" class="form-control txt-filter" id="from_stsnoS">
        </div>
    </div>

    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2  col-search">
        <div class="input-group">
            <div class="input-group-addon">To STS_NO</div>
            <input type="text" class="form-control txt-filter" id="to_stsnoS">
        </div>
    </div>

    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2  col-search">
        <div class="input-group">
            <div class="input-group-addon">Coil No</div>
            <input type="text" value="" class="form-control txt-filter" id="c_noS">
        </div>
    </div>

    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2  col-search">
        <div class="input-group">
            <div class="input-group-addon">Heat No</div>
            <input type="text"  class="form-control txt-filter" id="h_noS">
        </div>
    </div>

    <div class="col-lg-1 col-md-2 col-sm-1 col-xs-6  col-search">
        <button id="BtnSearchS" class="btn btn-info"><i class="fa fa-search"></i>Search</button>
    </div>
</div>

    <br>

    <div class="row" id="divReportS">
        <table class="table table-condensed table-bordered table-striped" id="tblReportS">
            <thead>
                <tr class="bg-gray">
                    <th rowspan="2">หมายเลข ปฏิบัติการ</th>                       
                    <th rowspan="2">size</th>
                    <th colspan='4'>Product</th>
                    <th colspan='6'>Mechanical Testing </th>
                    <th colspan='6' style='background-color:#FFCCCC;'>Not Accept Mechanical Testing</th>
                    <th colspan='4'>Charpy V-notch Testing Absorbed Energy (Joules)</th>
                    <th colspan='3'>Metallurgical Analysis</th>
                    <th colspan='5'>Production Date</th>
                </tr>
                <tr class="bg-gray">
                
                    <th>thick</th>
                    <th>length</th>
                    <th>standard</th>
                    <th>sts_no</th>
                    <th>Mec_test_TS</th>
                    <th>Mec_test_YS</th>
                    <th>Mec_test_EI</th>
                    
                    <th>≤15 <br> 12.00</th>
                    <th>>15≤30 <br> 14.00</th>
                    <th>>30 <br> 16.00</th>

                    <th style='background-color:#FFCCCC;'>Not_Mec_test_TS</th>
                    <th style='background-color:#FFCCCC;'>Not_Mec_test_YS</th>
                    <th style='background-color:#FFCCCC;'>Not_Mec_test_EI</th>
                    
                    <th style='background-color:#FFCCCC;'>≤15 <br> 12.00</th>
                    <th style='background-color:#FFCCCC;'>>15≤30 <br> 14.00</th>
                    <th style='background-color:#FFCCCC;'>>30 <br> 16.00</th>
                
                    <th>mean</th>
                    <th>1</th>
                    <th>2</th>
                    <th>3</th>

                    <th>P</th>
                    <th>F</th>
                    <th>M</th> 
                    
                    <th>hydro test</th>
                    <th>FM no.</th>
                    <th>produce date</th>
                    <th>thick x width</th>
                    <th>test date</th>
                </tr>
        </table>
    </div>

<script type="text/javascript">

    $("#BtnSearchS").click(function () {
            ReportAllSearch();
        });


    function ReportAllSearch() {
    var OldHtml = $("#BtnSearchS").html();
    var from_stsno = $("#from_stsnoS").val();
    var to_stsno = $("#to_stsnoS").val();
    var c_no = $("#c_noS").val();
    var h_no = $("#h_noS").val();
    if ((from_stsno == "") && (to_stsno == "") && ((h_no == "") && (c_no == ""))) {
        $.alert("กรุณาเลือกช่วง STS_NO หรือป้อนรายละเอียดเพื่อกรองข้อมูล");
    } else {
        $.ajax({
            type: 'POST',
            url: "././module/APP_Qc_TestLab/data.php",
            dataType: 'json',
            beforeSend: function () {
                $("#BtnSearchS").html("<i class='fa fa-spinner fa-spin'>");
            },
            data: {
                "load": "ReportSub",
                "from_stsno": from_stsno,
                "to_stsno": to_stsno,
                "c_no": c_no,
                "h_no": h_no
            },
            success: function (data) {
                console.log(data)
                $("#tblReportS").dataTable().fnDestroy();
                var table = $('#tblReportS').DataTable({
                    scrollY: "400px",
                    "scrollX": true,
                    scrollCollapse: true,
                    "aaData": data,
                    "paging": false,
                    "searching": false,
                    "bInfo": false,

                    "columns": [
                        {"data": "opr_no",
                            "className": "text-center",
                        },
                        {"data": "size",
                            "className": "text-center",
                        },
                        {"data": "thick_sub",
                        },
                        {"data": "length",
                        },
                        {"data": "standard_sub",
                        },
                        {"data": "sts_no",
                        },
                        {"data": "Mec_test_TS",
                            "className": "text-center",
                        },
                        {"data": "Mec_test_YS",
                            "className": "text-center",
                        },
                        {"data": "Mec_test_EI",
                            "className": "text-center",
                        },
                        {"data": "Mec_test_EL_1",
                            "className": "text-center",
                        },
                        {"data": "Mec_test_EL_2",
                            "className": "text-center",
                        },
                        {"data": "Mec_test_EL_3",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_TS",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_YS",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_EI",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_EL_1",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_EL_2",
                            "className": "text-center",
                        },
                        {"data": "Not_Mec_test_EL_3",
                            "className": "text-center",
                        },
                        {"data": "charpy_mean",
                            "className": "text-center",
                        },
                        {"data": "charpy1",
                            "className": "text-center",
                        },
                        {"data": "charpy2",
                            "className": "text-center",
                        },
                        {"data": "charpy3",
                            "className": "text-center",
                        },
                        {"data": "Metal_P",
                        "className": "text-center",
                        },
                        {"data": "Metal_F",
                            "className": "text-center",
                        },
                        {"data": "Metal_M",
                            "className": "text-center",
                        },
                        {"data": "Hydro_test",
                            "className": "text-center",
                        },
                        {"data": "prod_FM_no",
                            "className": "text-center",
                        },
                        {"data": "prod_date",
                            "className": "text-center",
                            "render": function (data, type, row, meta) {
                            var ret = formatDate(data);
                            return ret;
                        }
                        },
                        {"data": {thick: "thick", width: "width"},
                            "className": "text-center",
                            "render": function (data, type, row, meta) {
                            var ret = data.thick + " x " + data.width;
                            return ret;
                        }
                        },
                        
                        {"data": "test_date",
                            "className": "text-center",
                            "render": function (data, type, row, meta) {
                            var ret = formatDate(data);
                            return ret;
                        }
                        },
                    ],
                    'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'lf>>" +
                            "<'row'<'col-md-12'tr>>" +
                            "<'row'<'col-md-5 text-left'i><'col-sm-7 text-right'p>>",
                    buttons: [
                        {
                            extend: 'print',
                            text: "<i class='fa fa-print'></i>&nbsp;Print",
                            title: ''
                        },
                        {
                            extend: 'excel',
                            text: "<i class='fa fa-file-excel'></i>&nbsp;Excel&nbsp;",
                            title: `ReportSub sts_no ${from_stsno}-${to_stsno}`,
                            customize: function (xlsx) {
                                // var sheet = xlsx.xl.worksheets['sheet1.xml'];
                                // var numrows = 2;
                            }
                        },
                    ],
                });

                $('#tblReportS').loading("stop");
                $("#BtnSearchS").html("<i class='fa fa-search'></i>Search");
            },
            error: function (e) {
                console.log("There was an error with your request...");
                console.log("error: " + JSON.stringify(e));
            }
        });
    }
}
</script>
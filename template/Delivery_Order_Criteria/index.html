<style>
    .loading-spinner{
    width:30px;
    height:30px;
    border:2px solid indigo;
    border-radius:50%;
    border-top-color:#0001;
    display:inline-block;
    animation:loadingspinner .7s linear infinite;
}
@keyframes loadingspinner{
    0%{
        transform:rotate(0deg)
    }
    100%{
        transform:rotate(360deg)
    }
}
</style>

<div class="modal" id="modal-loading" data-backdrop="static">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-body text-center">
          <div class="loading-spinner mb-2"></div>
           <div>Loading</div>
        </div>
      </div>
    </div>
  </div>
<div class="row">
    <div class="mt-4">
        <h1 class="text-center">ใบขึ้นสินค้า (ในประเทศ)</h1>
    </div>
</div>
<div
    class="flex flex-col justify-center items-center w-5/6 mx-auto border-4 border-b-blue-400 border-white  shadow-2xl p-10 mt-10">
    <div class="row col-xs-12 p-20">
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div style="color: blue;" class="input-group-addon">Starting</div>
            </div>
            <div class="input-group basis-2/4">
                <div style="color: blue;" class="input-group-addon">Ending</div>
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div style="color: red;" class="input-group-addon">DO No. :</div>
                <input type="text" autocomplete="off" class="form-control" id="doc_cri_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="doc_cri_e">
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div class="input-group-addon">Customer :</div>
                <input type="text" autocomplete="off" class="form-control" id="customer_c_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="customer_c_e">
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div class="input-group-addon">Do Date :</div>
                <input type="text" autocomplete="off" class="form-control" id="do_date_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="do_date_e">
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div class="input-group-addon">Pick Up Date :</div>
                <input type="text" autocomplete="off" class="form-control" id="pick_date_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="pick_date_e">
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div class="input-group-addon">Co No. : :</div>
                <input type="text" autocomplete="off" class="form-control" id="co_no_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="co_no_e">
            </div>
        </div>
        <div class="flex justify-start items-center flex-grow gap-6 mb-5">
            <div class="input-group basis-2/4">
                <div class="input-group-addon">Item :</div>
                <input type="text" autocomplete="off" class="form-control" id="item_delivery_s">
            </div>
            <div class="input-group basis-2/4">
                <input type="text" autocomplete="off" class="form-control" id="item_delivery_e">
            </div>
        </div>
    </div>
    <div>
        <button id="PrintDelivery" class="btn btn-primary p-4 w-96"><i
                class="fa fa-searh"></i>&nbsp;Print</button>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bwip-js/4.5.1/bwip-js-min.js"
    integrity="sha512-nyvUcUIS1L4Z+cowD7We9KKcq/ivAJhTlhZTjBfBFGYV1I+RAqSrHS/WEcWDp1CVKRw1j5SxYCPCSYOQxuIE1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript">
    var username_session = GetUserProp("login_username");
    $("#r_name").val(username_session);

    function generateBarcode(text) {
        const canvas = document.createElement('canvas');
        try {
            bwipjs.toCanvas(canvas, {
                bcid: 'code128',
                text: text,
                scale: 3,
                height: 10,
                includetext: true,
                textxalign: 'center',
                textfont: 'Arial',
                textsize: 10


            });
            return canvas.toDataURL('image/png');
        } catch (error) {
            console.error('Error generating barcode:', error);
            throw error;
        }
    }

    $("#do_date_s, #do_date_e, #pick_date_s, #pick_date_e").datepicker({
        dateFormat: 'yy-mm-dd',
        // timeFormat: 'HH:mm',
        // controlType: 'select',
        // oneLine: true,
        // timeInput: true
    });


    $("#PrintDelivery").click(function () {
            PrintDeliveryImport();
    })

    function PrintDeliveryImport() {

        var logo = () => {
            let img = 'data:image/jpeg;base64,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'
            return img;
        }

        pdfMake.fonts = {
            THSarabunNew: {
                normal: 'THSarabunNew.ttf',
                bold: 'THSarabunNew Bold.ttf',
                italics: 'THSarabunNew-Italic.ttf',
                bolditalics: 'THSarabunNew-BoldItalic.ttf'
            },
            Roboto: {
                normal: 'Roboto-Regular.ttf',
                bold: 'Roboto-Medium.ttf',
                italics: 'Roboto-Italic.ttf',
                bolditalics: 'Roboto-MediumItalic.ttf'
            }
        };
        $.ajax({
            type: "POST",
            url: "././module/Delivery_Order_Criteria/data.php",
            dataType: "json",
            beforeSend: function () {
                $(function(){
                    $('#modal-loading').modal('show');
                });
            },
            data: {
                load: "Print",
                do_num_s: $("#doc_cri_s").val(),
                do_num_e: $("#doc_cri_e").val(),
                customer_c_s: $("#customer_c_s").val(),
                customer_c_e: $("#customer_c_e").val(),
                do_date_s: $("#do_date_s").val(),
                do_date_e: $("#do_date_e").val(),
                pick_date_s: $("#pick_date_s").val(),
                pick_date_e: $("#pick_date_e").val(),
                co_no_s: $("#co_no_s").val(),
                co_no_e: $("#co_no_e").val(),
                item_delivery_s: $("#item_delivery_s").val(),
                item_delivery_e: $("#item_delivery_e").val()
            },
            success: function (res) {
                $('#modal-loading').modal('hide');
                const newData = [];
                newData.push(res[0]);
                const filter = res.filter((value, index, self) =>
                    index === self.findIndex((t) => (
                        t.do_num + t.do_line === value.do_num + value.do_line
                    ))
                );
        
                function createData(newData, foot, result) {


                    const data = [];

                    data.push([
                        { text: `DO line`, fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "Do seq", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "รหัสสินค้า \n รายละเอียด", fontSize: 14, bold: true, alignment: 'center', style: 'header' },
                        { text: "Co. Order \n P/O No.", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "Co Line", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "Location", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "เส้น/มัด", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "จ.น. มัด \n เศษ", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "รวมเส้น \n Um", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "หน่วยนับขาย", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "น.น./เส้น (KG)", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "นํ้าหนักรวม", fontSize: 12, bold: true, alignment: 'center', style: 'header' }
                    ])

                    for (let i = 0; i < newData.length; i++) {
                        data.push([
                            { text: newData[i].do_line ? newData[i].do_line : '', fontSize: 11,bold: true, font: 'Roboto', alignment: 'center' },
                            { text: newData[i].do_seq ? newData[i].do_seq : '', fontSize: 11,bold: true,font: 'Roboto',  alignment: 'center' },
                            {
                                stack: [
                                    { image: generateBarcode(newData[i].item), width: 210, height: 25, alignment: 'center' },
                                    { text: newData[i].description ? newData[i].description : '', fontSize: 10, bold: true,font: 'Roboto', alignment: 'center' }
                                ], fontSize: 12, alignment: 'center'
                            },
                            { stack: [
                                { text: `${newData[i].Co_num ? newData[i].Co_num : ''}`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'left' },
                                { text: `${newData[i].cust_po ? newData[i].cust_po : ''}`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'right' },
                            ] },
                            { text: `[${newData[i].Co_line ? newData[i].Co_line : ''}]`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                            { text: newData[i].loc ? newData[i].loc : '', fontSize: 10,bold: true,font: 'Roboto', alignment: 'left' },
                            { text: `${newData[i].Uf_Pack ? newData[i].Uf_Pack : ''}`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                            { stack: [
                                { text: `${newData[i].QtyBundle ? newData[i].QtyBundle : ''}`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'left' },
                                { text: `${newData[i].QtyRemainder ? newData[i].QtyRemainder : ''}`, fontSize: 11,bold: true,font: 'Roboto', alignment: 'right' },
                            ] },
                            { stack: [
                                { text: newData[i].Qty ? Number(newData[i].Qty).toFixed(0) : '', fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                                { text: newData[i].S_u_m ? newData[i].S_u_m : '', fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                            ] },
                            { text: newData[i].u_m ? newData[i].u_m : '', fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                            { text: newData[i].unit_weight ? Number(newData[i].unit_weight).toFixed(2) : '', fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                            { text: newData[i].SumWeight ? addCommas(Number(newData[i].SumWeight).toFixed(2)) : '', fontSize: 11,bold: true,font: 'Roboto', alignment: 'center' },
                        ],)
                        // how fixed position footer


                        if (i == newData.length - 1 && foot) {
                            let countRemain = result.filter((x) => x.QtyRemainder > 0).length;
                            data.push([
                                    { text: `หมายเหตุ : ${newData[i].NoteContent ? newData[i].NoteContent : ''}`, fontSize: 13,bold: true, alignment: 'left', colSpan: 7 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: result.reduce((a, b) => a + b.QtyBundle, 0) + countRemain, fontSize: 11,bold: true,font: 'Roboto',  alignment: 'center' },
                                    { text: result.reduce((a, b) => a + Number(b.Qty), 0), fontSize: 11,bold: true,font: 'Roboto',  alignment: 'center' },
                                    { text: newData[i].u_m, fontSize: 11,bold: true,font: 'Roboto',  alignment: 'center' },
                                    { text: '', fontSize: 11, font: 'Roboto', alignment: 'center' },
                                    { text: addCommas(result.reduce((a, b) => a + Number(b.SumWeight), 0).toFixed(2)), fontSize: 11, font: 'Roboto', bold: true, alignment: 'center' },
                                ],)
                            if (newData.length == 1) {
                                for (let i = 0; i < 9; i++) {
                                    data.push([
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                    ])
                                }
                            }

                            if (newData.length == 2) {
                                for (let i = 0; i < 7; i++) {
                                    data.push([
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                    ])
                                }
                            }

                            if (newData.length == 3) {
                                for (let i = 0; i < 5; i++) {
                                    data.push([
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                    ])
                                }
                            }


                            if (newData.length == 4) {
                                for (let i = 0; i < 2; i++) {
                                    data.push([
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                    ])
                                }
                            }

                            if (newData.length == 5) {
                                for (let i = 0; i < 1; i++) {
                                    data.push([
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                        { border: [false, false, false, false], text: " ", fontSize: 12, alignment: 'center' },
                                    ])
                                }
                            }

                            if (result.length <= 5) {
                                data.push([
                                    { border: [false, false, false, false], text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: `Request By (ผู้เบิก) : ${username_session}`, colSpan: 11, fontSize: 12, bold: true, alignment: 'left', colSpan: 2, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "Loaded By (พนักงานโหลดสินค้า) : ________________________", fontSize: 12,bold: true, alignment: 'left', colSpan: 5, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "นํ้าหนักของโดยประมาณ : ________________________Kgs.", fontSize: 12,bold: true, alignment: 'left', colSpan: 4, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: '', fontSize: 12, bold: true, alignment: 'center' },
                                ],)

                                data.push([
                                    { border: [false, false, false, false], text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: `Approved By (ผู้อนุมัติ) : ${newData[i].CreatedBy}`, colSpan: 11, fontSize: 12, bold: true, alignment: 'left', colSpan: 2 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "Transporter (บริษัทขนส่ง) : ________________________ ", fontSize: 12,bold: true, alignment: 'left', colSpan: 5 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "นํ้าหนักห้องตาชั่ง : ________________________ Kgs.", fontSize: 12,bold: true, alignment: 'left', colSpan: 4 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: '', fontSize: 12, bold: true, alignment: 'center' },
                                ],)
                            } else {
                                if (foot) {
                                    data.push([
                                    { border: [false, false, false, false], text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: `Request By (ผู้เบิก) : ${username_session}`, colSpan: 11, fontSize: 12, bold: true, alignment: 'left', colSpan: 2, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "Loaded By (พนักงานโหลดสินค้า) : ________________________", fontSize: 12,bold: true, alignment: 'left', colSpan: 5, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "นํ้าหนักของโดยประมาณ : ________________________Kgs.", fontSize: 12,bold: true, alignment: 'left', colSpan: 4, margin: [0, 20, 0, 0] },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: '', fontSize: 12, bold: true, alignment: 'center' },
                                ],)

                                data.push([
                                    { border: [false, false, false, false], text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: `Approved By (ผู้อนุมัติ) : ${newData[i].CreatedBy}`, colSpan: 11, fontSize: 12, bold: true, alignment: 'left', colSpan: 2 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "Transporter (บริษัทขนส่ง) : ________________________", fontSize: 12, bold: true, alignment: 'left', colSpan: 5 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { border: [false, false, false, false], text: "นํ้าหนักห้องตาชั่ง : ________________________ Kgs.", fontSize: 12, bold: true, alignment: 'left', colSpan: 4 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: '', fontSize: 12, bold: true, alignment: 'center' },
                                ],)
                                }
                            }
                        }

                    }

                    if (newData.length == 0) {
                        for (let i = 0; i < 5; i++) {
                            data.push([
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },

                            ])
                        }
                    }

                    return data
                }

                function createTables() {
                    const tables = [];
                    let currentPage = 0;
                    for (let i = 0; i < filter.length; i++) {
                        let result = res.filter((value) =>
                            value.do_num + value.do_line === filter[i].do_num + filter[i].do_line
                        );
                        
                        for (let j = 0; j < result.length;) {
                            currentPage++;
                            const newRes = result.slice(j, j + 5);
                            const isLastPage = j + 5 >= result.length; // ตรวจสอบว่าหน้าสุดท้ายหรือไม่

                            const maxPage = Math.ceil(result.length / 5);

                            if (!newRes.length) {
                                continue;
                            }

                            tables.push({
                                table: {
                                    headerRows: 1,
                                    widths: [25, 25, 220, 80, 25, 40, 30, 40, 30, 50, 50, 80],
                                    body: createData(newRes, isLastPage, result),
                                },
                                pageBreak: j + 5 < result.length || i < filter.length - 1 ? 'after' : '',
                                pageData: newRes,
                                currentPage: `${currentPage} / ${maxPage}`,

                            });

                            j += 5; // ขยับทีละ 5
                        }
                        currentPage = 0;

                    }


                    return tables;
                }

                var docDefinition = {
                    pageSize: 'A4',
                    pageOrientation: 'landscape',
                    pageMargins: [20, 200, 50, 5],
                    header: function (currentPage, pageCount, pageSize) {
                        const data = this.pageData
                
                        const pageData = data.map((table) => table.pageData);
                        const page = data.map((table) => table.currentPage);
    
                   
                        
                   
                        
                        
                        return {
                            margin: [15, 10, 0, 0],
                            table: {
                                widths: [300, 250, 225],
                                body: [
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            bold: true,
                                            text: ``,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 25,
                                            bold: true,
                                            text: `ใบขึ้นสินค้า (ในประเทศ)`,
                                            alignment: 'center',
                                            margin: [-30, 0, 0, 0],
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            text: `Page ${page[currentPage - 1]}`,
                                            alignment: 'right',
                                            margin: [0, 15, 0, 0],
                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 18,
                                            bold: true,
                                            columns: [
                                                { text: `DO :`, alignment: 'center' },
                                                { image: generateBarcode(String(pageData[currentPage - 1]?.[0].do_num)), width: 100, alignment: 'left', margin: [-10, 0, 0, 0], },
                                                { text: `Line : `, alignment: 'right' },
                                                { image: generateBarcode(String(pageData[currentPage - 1]?.[0].do_line)), width: 50, alignment: 'right', margin: [-10, 0, 0, 0], },
                                            ],
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `แผนก : จัดส่งและคลังสินค้า`,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            image: logo(), width: 225, alignment: 'center', margin: [0, 10, 0, 0],
                                            alignment: 'right',

                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 18,
                                            bold: true,

                                            columns: [
                                                { text: `CO :`, alignment: 'center', },
                                                { image: generateBarcode(String(pageData[currentPage - 1]?.[0].Co_num)), width: 100, margin: [-90, 0, 0, 0], alignment: 'left', },
                                            ],
                                            alignment: 'left',
                                            margin: [-65, 0, 50, 0],

                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 13,
                                            bold: true,
                                            text: `ลูกค้า : ${pageData[currentPage - 1]?.[0].Co_num ? pageData[currentPage - 1]?.[0].Co_num : ''} ${pageData[currentPage - 1]?.[0].HQname ? pageData[currentPage - 1]?.[0].HQname : ''} \n ship to : ${pageData[currentPage - 1]?.[0].name ? pageData[currentPage - 1]?.[0].name : ''}`,
                                            alignment: 'left',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            text: `วันที่เอกสาร : ${moment(pageData[currentPage - 1]?.[0].do_hdr_date?.date).format('DD/MM/YYYY')} \n วันที่ส่งสินค้า : ${moment(pageData[currentPage - 1]?.[0].pickup_date?.date).format('DD/MM/YYYY')}`,
                                            alignment: 'left',
                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `STS_PO : ${pageData[currentPage - 1]?.[0].Uf_refno ? pageData[currentPage - 1]?.[0].Uf_refno : ''} `,
                                            alignment: 'left',
                                            margin: [30, 0, 0, 0],

                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 20,
                                            bold: true,
                                            text: `${pageData[currentPage - 1]?.[0].city ? pageData[currentPage - 1]?.[0].city : ''}`,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `เลขที่เอกสาร : ${pageData[currentPage - 1]?.[0].do_num || ''}`,
                                            alignment: 'left',
                                        },
                                    ],
                                ],
                            },
                        };
                    }.bind({ pageData: createTables().map(table => table) }),
                    content: createTables(),
                    defaultStyle: {
                        font: 'THSarabunNew',
                    },
                };

                pdfMake.createPdf(docDefinition,).open()
            }

        });
    }

    function PrintDeliveryExport() {

        var logo = () => {
            let img = 'data:image/jpeg;base64,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'
            return img;
        }

        pdfMake.fonts = {
            THSarabunNew: {
                normal: 'THSarabunNew.ttf',
                bold: 'THSarabunNew Bold.ttf',
                italics: 'THSarabunNew-Italic.ttf',
                bolditalics: 'THSarabunNew-BoldItalic.ttf'
            },
            Roboto: {
                normal: 'Roboto-Regular.ttf',
                bold: 'Roboto-Medium.ttf',
                italics: 'Roboto-Italic.ttf',
                bolditalics: 'Roboto-MediumItalic.ttf'
            }
        };
        $.ajax({
            type: "POST",
            url: "././module/Delivery_Order_Criteria/data.php",
            dataType: "json",
            data: {
                load: "Print",
                do_num_s: $("#doc_cri_s").val(),
                do_num_e: $("#doc_cri_e").val(),
                customer_c_s: $("#customer_c_s").val(),
                customer_c_e: $("#customer_c_e").val(),
                do_date_s: $("#do_date_s").val(),
                do_date_e: $("#do_date_e").val(),
                pick_date_s: $("#pick_date_s").val(),
                pick_date_e: $("#pick_date_e").val(),
                co_no_s: $("#co_no_s").val(),
                co_no_e: $("#co_no_e").val(),
                item_delivery_s: $("#item_delivery_s").val(),
                item_delivery_e: $("#item_delivery_e").val()
            },
            beforeSend: function () {
                $(function () {
                    $('#modal-loading').modal('show');
                });
            },
            success: function (res) {
                $('#modal-loading').modal('hide');
                const newData = [];
                newData.push(res[0]);
                const filter = res.filter((value, index, self) =>
                    index === self.findIndex((t) => (
                        t.do_num + t.do_line === value.do_num + value.do_line
                    ))
                );
    
                function createData(newData,isLastPage,result) {


                    const data = [];

                    data.push([
                        { text: `DO. LINE`, fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "ลำดับ Do.seq", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "Co. Order \n P/O No.", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "Co. Line", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "STS PO", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "เส้น/มัด", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "จ.น. มัด \n เศษ", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "รวมเส้น Um", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "หน่วยขาย", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "น.น./เส้น (KG)", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "นํ้าหนักรวม", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                        { text: "รหัสสินค้า", fontSize: 12, bold: true, alignment: 'center', style: 'header' },
                    ])

                    for (let i = 0; i < newData.length; i++) {
                        data.push([
                            { text: newData[i].do_line, fontSize: 12,bold: true, alignment: 'center' },
                            { text: newData[i].do_seq, fontSize: 12,bold: true, alignment: 'center' },
                            {
                                stack: [
                                    { image: generateBarcode(newData[i].Co_num), width: 100, alignment: 'center' },
                                    { text: newData[i].cust_po ? newData[i].cust_po : '', fontSize: 12,bold: true, alignment: 'center' }
                                ], fontSize: 12, alignment: 'center'
                            },
                            { text: `[${newData[i].Co_line ? newData[i].Co_line : ''}]`, fontSize: 12,bold: true, alignment: 'center' },
                            { text: newData[i].Uf_refno ? newData[i].Uf_refno : '', fontSize: 12,bold: true, alignment: 'center' },
                            { text: newData[i].Uf_Pack ? newData[i].Uf_Pack : '', fontSize: 12,bold: true, alignment: 'center' },
                            { stack: [
                                { text: `${newData[i].QtyBundle}`, fontSize: 12,bold: true, alignment: 'left' },
                                { text: `${newData[i].QtyRemainder}`, fontSize: 12,bold: true, alignment: 'right' },
                            ] },
                            { stack: [
                                { text: Number(newData[i].Qty).toFixed(0), fontSize: 12,bold: true, alignment: 'center' },
                                { text: `${newData[i].S_u_m}`, fontSize: 12,bold: true, alignment: 'right' },
                            ] },
                            { text: newData[i].S_u_m, fontSize: 12,bold: true, alignment: 'center' },
                            { text: Number(newData[i].unit_weight).toFixed(2), fontSize: 12,bold: true, alignment: 'center' },
                            { text: addCommas(Number(newData[i].SumWeight).toFixed(2)), fontSize: 12,bold: true, alignment: 'center' },
                            {
                                stack: [
                                    { image: generateBarcode(newData[i].item), width: 220, alignment: 'center' },
                                    { text: newData[i].description, fontSize: 12,bold: true, alignment: 'center' },
                                ], fontSize: 12, alignment: 'center'
                            },

                        ],)

                        if (i == newData.length - 1 && isLastPage) {
                            let countRemain = result.filter((x) => x.QtyRemainder > 0).length;
                            data.push([
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "หมายเหตุ", fontSize: 11,bold: true, alignment: 'center' },
                                    { text: `รวม DO Line ${newData[i].do_line}`, fontSize: 12,bold: true, alignment: 'right', colSpan: 4 },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: "", fontSize: 12, alignment: 'center' },
                                    { text: result.reduce((a, b) => a + b.QtyBundle, 0) + countRemain, fontSize: 12,bold: true, alignment: 'center' },
                                    { text: result.reduce((a, b) => a + Number(b.Qty), 0), fontSize: 12,bold: true, alignment: 'center' },
                                    { text: newData[i].u_m, fontSize: 12,bold: true, alignment: 'center' },
                                    { text: '', fontSize: 12, alignment: 'center' },
                                    { text: addCommas(result.reduce((a, b) => a + Number(b.SumWeight), 0).toFixed(2)), fontSize: 12, bold: true, alignment: 'center' },
                                    { text: '', fontSize: 12, alignment: 'center' },
                                ],)
                        }
                    }

                    if (newData.length == 0) {
                        for (let i = 0; i < 5; i++) {
                            data.push([
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },
                                { text: "", fontSize: 12, alignment: 'center' },

                            ])
                        }
                    }

                    return data
                }

                function createTables() {
                    const tables = [];
                    let currentPage = 0;
                    for (let i = 0; i < filter.length; i++) {
                        let result = res.filter((value) =>
                            value.do_num + value.do_line === filter[i].do_num + filter[i].do_line
                        );
                        for (let j = 0; j < result.length; j += 4) {
                            const isLastPage = j + 4 >= result.length; // ตรวจสอบว่าหน้าสุดท้ายหรือไม่
                            const newRes = result.slice(j, j + 4);

                            if (!newRes.length) {
                                continue;
                            }
                            tables.push({
                                table: {
                                    headerRows: 1,
                                    widths: [25, 30, 120, 25, 40, 30, 40, 40, 30, 50, 50, 220],
                                    body: createData(newRes, isLastPage,result),
                                },
                                // 

                                pageBreak: j + 4 < result.length || i < filter.length - 1 ? 'after' : '',
                                pageData: newRes,



                            });
                            currentPage++;
                        }
                    }

                    return tables;
                }

                var docDefinition = {
                    pageSize: 'A4',
                    pageOrientation: 'landscape',
                    pageMargins: [20, 200, 50, 75],
                    header: function (currentPage, pageCount, pageSize) {
                        const pageData = this.pageData || {};

                        // if have a pageBreak no header




                        return {
                            margin: [15, 10, 0, 0],
                            table: {
                                widths: [300, 225, 250],
                                body: [
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            bold: true,
                                            text: ``,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 25,
                                            bold: true,
                                            text: `ใบขึ้นสินค้า`,
                                            alignment: 'center',
                                            margin: [-30, 0, 0, 0],
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            text: `Page ${currentPage} / ${pageCount}`,
                                            alignment: 'right',
                                            margin: [0, 15, 0, 0],
                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 20,
                                            bold: true,
                                            columns: [
                                                { text: `DO :`, alignment: 'center' },
                                                { image: generateBarcode(String(pageData[currentPage - 1]?.[0].do_num)), width: 100, alignment: 'left', margin: [-80, 0, 0, 0], },
                                            ],
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `แผนก : จัดส่งและคลังสินค้า`,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            image: logo(), width: 250, alignment: 'center', margin: [0, 10, 0, 0],
                                            alignment: 'right',

                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 18,
                                            bold: true,

                                            columns: [
                                                { text: `Line :`, alignment: 'center', },
                                                { image: generateBarcode(String(pageData[currentPage - 1]?.[0].do_line)), width: 50, margin: [0, 0, 80, 0], },
                                            ],
                                            alignment: 'center',
                                            margin: [0, 0, 50, 0],

                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 14,
                                            text: ``,
                                            alignment: 'right',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            text: `วันที่เอกสาร : ${moment().format('DD/MM/YYYY')} \n วันที่ส่งสินค้า : ${moment().format('DD/MM/YYYY')}`,
                                            alignment: 'left',
                                        },
                                    ],
                                    [
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `รหัสลูกค้า : ${pageData[currentPage - 1]?.[0].cust_num} ${pageData[currentPage - 1]?.[0].name}  `,
                                            alignment: 'center',

                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 20,
                                            bold: true,
                                            text: `${pageData[currentPage - 1]?.[0].city ? pageData[currentPage - 1]?.[0].city : ''}`,
                                            alignment: 'center',
                                        },
                                        {
                                            border: [false, false, false, false],
                                            fontSize: 16,
                                            bold: true,
                                            text: `เลขที่เอกสาร : ${pageData[currentPage - 1]?.[0].do_num || ''}`,
                                            alignment: 'left',
                                        },
                                    ],
                                ],
                            },
                        };
                    }.bind({ pageData: createTables().map(table => table.pageData) }),
                    content: createTables(),
                    footer: function (currentPage, pageCount) {
                        const pageData = this.pageData || {};
                        let countRemain = newData.filter((x) => x.QtyRemainder > 0).length;
                        const totalSum = res.reduce((a, b) => a + Number(Number(b.SumWeight).toFixed(2)), 0);
                        const totalQty = res.reduce((a, b) => a + Number(b.Qty), 0);
                        const totalQtyBundle = res.reduce((a, b) => a + b.QtyBundle, 0);
                          console.log(countRemain,'countRemain');
                          

                        if (currentPage === pageData.length) {
                            return {
                                margin: [0, 0, 0, 0],
                                table: {
                                    widths: [220, 350, 250],
                                    body: [
                                        [
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: ``,
                                                alignment: 'center',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `รวมทุก DO Line                ${addCommas(totalQtyBundle + countRemain)}            ${addCommas(totalQty)}                                ${addCommas((totalSum).toFixed(2))}`,
                                                alignment: 'left',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: ``,
                                                alignment: 'center',
                                            },
                                        ],
                                        [
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `Request By (ผู้เบิก) : ${username_session}`,
                                                alignment: 'center',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `Loaded By (พนักงานโหลดสินค้า) : ___________________________`,
                                                alignment: 'center',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `นํ้าหนักของโดยประมาณ : ____________________Kgs.`,
                                                alignment: 'left',
                                            },
                                        ],
                                        [
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `Approved By (ผู้อนุมัติ) : ${pageData[currentPage - 1]?.[0].createdBy}`,
                                                alignment: 'center',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `Transported (บริษัทขนส่ง) : ___________________________`,
                                                alignment: 'center',
                                            },
                                            {
                                                border: [false, false, false, false],
                                                fontSize: 14,
                                                bold: true,
                                                text: `นํ้าหนักห้องตาชั่ง : _______________________Kgs.`,
                                                alignment: 'left',
                                            },
                                        ],
                                    ]
                                }
                            };
                        } else {
                            return false;
                        }



                    }.bind({ pageData: createTables().map(table => table.pageData) }),
                    defaultStyle: {
                        font: 'THSarabunNew',
                    },
                };

                pdfMake.createPdf(docDefinition,).open()
            }

        });
    }



</script>
<style>
    .mycontainer {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 90%;
        margin-left: auto;
        margin-right: auto;
        border-width: 4px;
        border-bottom-color: #60a5fa;
        border-top-color: white;
        border-left-color: white;
        border-right-color: white;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        padding: 6rem;
        margin-top: 2.5rem;
        @media (max-width: 768px) {
            padding: 1rem;
            flex-direction: column;;
        }
    }

    .mybox {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        flex-grow: 1;
        gap: 1.5rem;
        margin-bottom: 1.25rem;
        @media (max-width: 768px) {
            padding: 1rem;
            flex-direction: column;
        }
    }

    .item {
        width: 50%;
        @media (max-width: 768px) {
            width: 100%;
        }
    }

  

    .mybox2 {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        flex-grow: 1;
        margin-bottom: 1.25rem;
        @media (max-width: 768px) {
            padding: 1rem;
            flex-direction: column;
            gap: 1.5rem;
        }
    }

    .btn-1 {
        @media (max-width: 768px) {
            flex-direction: column;
            gap: 0.5rem;
        }
    }

    .btn-2 {
        gap: 3rem;
        @media (max-width: 768px) {
            gap: 0.5rem;
            flex-wrap: wrap;
        }
    }

</style>
<div class="">
    <div class="col-xs-12">
        <div class="page-header">
            <h1 class="text-header text-left">เปิดใบเบิกของ</h1>
        </div>
    </div>
</div>
<div class="mycontainer mb-12">
    <div class="row col-xs-12">
        <div class="mybox">
            <div class="sm:basis-3/6 w-full">
                <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">Doc No</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="doc_no_w">
                    <option value=""></option>
                </select>
            </div>
            <div class="input-group basis-3/6">
                <div class="flex gap-6">
                    <button type="button" class="btn btn-primary btn-lg" id="btnSearchBooking">Search</button>
                    <button type="button" class="btn btn-warning btn-lg" id="btnResetWithdraw">Reset Form</button>
                </div>
            </div>
        </div>
        <hr />
        <div class="mybox">
            <div class="input-group basis-3/6">
                <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">ผู้เบิก</div>
                <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="user_w" readonly>
            </div>
            <div class="input-group basis-3/6">

            </div>
            <div class="input-group basis-3/6 hidden">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">Doc</div>
                <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="doc_no_w_old" readonly>
            </div>
        </div>
        <div class="mybox">
            <div class="input-group item">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">แผนก *</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="dept_w">
                    <option value=""></option>
                </select>
            </div>
            <div class="input-group item">
                <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">หมายเหตุ</div>
                <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="remark_withdraw">
            </div>
            <!-- <div class="input-group basis-3/6">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">เครื่อง *</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="wc_w">
                    <option value=""></option>
                </select> 
            </div> -->
        </div>
        <hr />
        <div class="mybox2">
            <div class="input-group basis-3/6 mr-5">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">Item *</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="item_w">
                    <option value=""></option>
                </select>
            </div>
            <div class="input-group basis-2/6">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">จำนวน *</div>
                <input type="number" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" 
                    id="qty_w">
            </div>
            <div class="input-group basis-1/6 pl-4">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">หน่วย</div>
                <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="um_w"
                    readonly>
            </div>
        </div>
        <div class="mybox">
            <div class="input-group basis-3/6">
                <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">แผนก / เครื่อง *
                </div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter" id="wc_dest">
                    <option value=""></option>
                </select>
            </div>
            <div class="input-group basis-3/6">
                <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">หมายเหตุ </div>
                <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="remark_w">
            </div>
        </div>
        <div class="flex justify-between btn-1">
            <div class="flex btn-2">
                <button type="button" class="btn btn-success btn-lg" id="btnAddItemWithdraw">1 Add Item</button>
                <button style="display: none;" type="button" class="btn btn-danger btn-lg" id="approve_user"
                    onclick="approve_user()">รับของ</button>

                <button type="button" class="btn btn-warning btn-lg" id="approve_one" onclick="approve_one()">อนุมัติ
                    1</button>


                <button type="button" class="btn btn-warning btn-lg" id="approve_two" onclick="approve_two()">อนุมัติ
                    2</button>

            </div>
            <div>
                <button type="button" class="btn btn-success btn-lg" id="btnAddWithdraw">2 Create</button>
                <button type="button" class="btn btn-info btn-lg" id="btnUpdateW" disabled>Update</button>
            </div>
        </div>
        <input type="text" style="font-weight: bold; font-size: 16px;" class="hidden" id="old_co_num">
    </div>
</div>
<div class="row">
    <table width="100%" class="table table-condensed table-bordered table-striped" id="tbItemWithdraw">
        <thead>
            <tr>
                <th class="bg-gray">Item</th>
                <th class="bg-gray">รายละเอียด</th>
                <th class="bg-gray">จำนวน</th>
                <th class="bg-gray">จำนวนที่เบิกได้</th>
                <th class="bg-gray">หน่วย</th>
                <th class="bg-gray">นำไปใช้</th>
                <th class="bg-gray">หมายเหตุ</th>
            </tr>
        </thead>
        <!--        <tbody id="tblReportList">
                      <tr><td align="center" colspan="12">.... No item search ....</td></tr>
     </tbody>-->
    </table>
</div>
<!-- Modal -->
<div class="modal fade bd-example-modal-lg" id="ModalWithdraw" role="dialog" aria-labelledby="myLargeModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title text-center" id="exampleModalLabel">แก้ไขข้อมูล Item</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
            </div>
            <div class="modal-body">
                <div class="mybox2">
                    <div class="input-group basis-3/6 mr-5">
                        <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">Item *
                        </div>
                        <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                            id="item_w_edit">
                            <option value=""></option>
                        </select>
                    </div>
                    <div class="input-group basis-2/6">
                        <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">จำนวน *
                        </div>
                        <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                            id="qty_w_edit">
                    </div>
                    <div class="input-group basis-1/6 pl-4">
                        <input type="text" style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                            id="um_w_edit" readonly>
                    </div>
                </div>
                <div class="flex flex-row justify-center items-center flex-grow gap-6 mb-5">
                    <div class="input-group basis-2/4">
                        <div style="color: red; font-weight: bold; font-size: 16px;" class="input-group-addon">นำไปใช้ *
                        </div>
                        <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                            id="wc_dest_edit">
                            <option value=""></option>
                        </select>
                    </div>
                    <div class="input-group basis-2/4">
                        <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">หมายเหตุ</div>
                        <input style="font-weight: bold; font-size: 16px;" type="text" autocomplete="off"
                            class="form-control" id="remark_w_edit">
                    </div>
                </div>
                <input style="font-weight: bold; font-size: 16px;" type="text" autocomplete="off"
                    class="form-control hidden" id="doc_no_w_edit">
                <input style="font-weight: bold; font-size: 16px;" type="text" autocomplete="off"
                    class="form-control hidden" id="line_id_w_edit">
                <input style="font-weight: bold; font-size: 16px;" type="text" autocomplete="off"
                    class="form-control hidden" id="row">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="SaveCalibration"
                    onclick="SaveWithdrawItem()">บันทึก</button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bwip-js/4.5.1/bwip-js-min.js"
    integrity="sha512-nyvUcUIS1L4Z+cowD7We9KKcq/ivAJhTlhZTjBfBFGYV1I+RAqSrHS/WEcWDp1CVKRw1j5SxYCPCSYOQxuIE1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript">
    /*************  ✨ Windsurf Command 🌟  *************/
    var userApproveOne = [
        "Surachai",
        "Suphan",
        "Kitichai",
        "Somporn",
        "Wanupob",
        "Nitinai",
        "Insorn",
        "Ekaphot",
        "Kanitta",
        "Gharul",
        "Chalaw",
        "Natee",
        "Nongnuch",
        "Chakun",
        "Wuttichai",
        "Anusak",
        "Prasit",
        "Sandals",
        "Bunlu",
        "Vichai",
        "Viroch",
        "Somboon",
        "Pichaya",
        "Niyom",
        "Nopporn",
        "Aphisit",
        "Rimkong",
        "Narin",
        "Rattanapat",
        "Janjira",
        "Boonma",
        "Kittisak",
        "Jakkrit",
        "Aekkarat",
        "Nantida",
        "Songkarn",
        "Vorawut",
        "Sukanya",
        "Poonsook",
        "yothin",
        "Yuthana",
        "Jakkarin",
        "kanjamas",
        "Pongsatorn",
        "Pairoj",
        "Chamnan",
        "Sam-Ang",
        "Suriyakan",
        "Admin",
        "Natchalida",
        "Supachai",
        "Canth",
        "Sanay",
        "Chalermphing",
        "JARIYA",
        "Nattawut",
        "orasa",
        "THANAWAT",
        "kasemkit",
        "Kanthanat",
        "NIPAPORN",
        "Panida",
        "natchaisan",
        "onanong",
        "yajai",
        "Theerawut",
        "Amorn",
        "Nittaya",
        "Tanes",
        "Anuchai",
        "Yutthakarn",
        "panusit",
        "Sanei",
        "Jan",
        "gharul",
        "vichai"
    ];

    var userApproveTwo = [
        "Vorawut",
        "Sukanya",
        "Poonsook",
        "yothin",
        "Yuthana",
        "Jakkarin",
        "kanjamas",
        "Pongsatorn",
        "Pairoj",
        "Chamnan",
        "Sam-Ang",
        "Suriyakan",
        "Admin",
        "Anuchai",
        "Nittaya",
        "Supachai",
        "orasa",
        "THANAWAT",
        "kasemkit",
        "Kanthanat",
        "YODCHAI",
        "tanapol.tec",
        "yajai",
        "Theerawut",
        "Amorn",
        "Nittaya"
    ];

    var arr_lang = [
        "คลังวัดถุ",
        "คลังวัดถุดิบ",
        "คลังขายในประเทศ",
        "คลังขายต่างประเทศ",
        "จัดส่ง",
        "จัดซื้อ",
        "บัญชี",
        "ตรวจสอบภายใน",
        "ขายต่างประเทศ",
        "ขายในประเทศ",
        "ฝ่ายบุคคล",
        "IT",
        "เตาชุบ",
        "พิมพ์ตรา",
        "ต๊าปเกลียว",
        "กรุ๊ปปลายท่อ",
        "พ่นสี",
        "ตัดแบ่งความยาว",
        "มัดท่อ",
        "ฟอร์มมิ่ง",
        "เทสน้ำ",
        "ดัดตรง",
        "คว้านหัว",
        "เครื่องตัด /สลิต",
        "ไฟฟ้า เครื่องกลึง",
        "ซ่อมบำรุง วิศวกร",
        "QC ห้องแล็ป",
        "วังน้อย-ฟอร์มมิ่ง",
        "วังน้อย-เทสน้ำ",
        "วังน้อย-ดัดตรง",
        "วังน้อย-เครื่องตัด /สลิต",
        "วังน้อย-กรุ๊ปปลายท่อ",
        "วังน้อย-มัดท่อ",
        "วังน้อย-ฝ่ายจัดซื้อ(สโตร์)",
        "วังน้อย-วางแผนการผลิต",
        "วังน้อย-จัดส่งสินค้า",
        "วังน้อย-แผนกคลังวัตถุดิบ",
        "วังน้อย-แผนกคลังสินค้าสำเร็จรูป",
        "วังน้อย-ไฟฟ้า",
        "วังน้อย-ซ่อมบำรุง",
        "วังน้อย-เครื่องกลึง",
        "วังน้อย-ส่วนกลางโรงงาน",
        "วังน้อย-สำนักงานกลาง",
        "วังน้อย-ฝ่ายบุคคล-ธุรการ",
        "วังน้อย-QC"
    ];

    var username_session = GetUserProp("login_username");
    $("#user_w").val(username_session);

    getDocNumList();

    var data_withdraw = [];

    var deptOption = arr_lang.map(function (item) {
        return {
            id: item,
            text: item
        };
    })

     $("#dept_w").select2({
                placeholder: 'กรุณาเลือกแผนก',
                allowClear: true,
                width: '100%',
                data: deptOption,
                language: {
                    noResults: function () {
                        return "ไม่พบข้อมูล";
                    }
                }
    });

    function generateBarcode(text) {
        const canvas = document.createElement('canvas');
        try {
            bwipjs.toCanvas(canvas, {
                bcid: 'code128',
                text: text,
                scale: 3,
                height: 10,
                includetext: true,
                textxalign: 'center',
                textfont: 'Arial',
                textsize: 10


            });
            return canvas.toDataURL('image/png');
        } catch (error) {
            console.error('Error generating barcode:', error);
            throw error;
        }
    }

    function getDocNumList() {
        $.ajax({
            type: "GET",
            url: "././module/APP_STORE_WITHDRAW/data.php",
            dataType: "json",
            data: {
                load: "GetDocList"
            },
            success: function (data) {
                let doc;

                var username_session_trim = username_session.trim().toLowerCase();
                if (!userApproveOne.map(x => x.trim().toLowerCase()).includes(username_session_trim) && !userApproveTwo.map(x => x.trim().toLowerCase()).includes(username_session_trim)) {
                 var newData = data.filter(x => x.user.trim().toLowerCase() == username_session_trim);
                 doc = [{ id: '', text: '' }].concat(newData.map((item) => ({
                        id: item.doc_no,
                        text: item.doc_no,
                        userApprove: item.userApprove,
                        approver1: item.approver1,
                        approver2: item.approver2
                 })));
             
                } else {
                    doc = [{ id: '', text: '' }].concat(data.map((item) => ({
                        id: item.doc_no,
                        text: item.doc_no,
                        userApprove: item.userApprove,
                        approver1: item.approver1,
                        approver2: item.approver2
                    })));
                }

          
                $("#doc_no_w").empty();
                $("#doc_no_w").select2({
                    placeholder: 'Doc No',
                    allowClear: true,
                    width: '100%',
                    data: doc,
                    language: {
                        noResults: function () {
                            return "ไม่พบข้อมูล";
                        }
                    },
                    templateResult: function (state) {
                        if (!state.id) return state.text;

                        var $state = $('<div></div>');
                        var docNo = `<span style="font-weight: bold; font-size: 15px;">${state.id}</span>`;
                        var statusHtml = '';

                        // สร้าง badge สำหรับ userApprove
                        var approveStatus = '';
                        if (state.userApprove == 1) {
                            approveStatus = '<span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px; margin-right: 4px;">รับของ</span>';
                        } else {
                            approveStatus = '<span style="background-color: #dc3545; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px; margin-right: 4px;">รับของ</span>';
                        }

                        // สร้าง badge สำหรับ stock
                        var approver1 = '';
                        if (state.approver1 !== null && state.approver1 !== '') {
                            approver1 = '<span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px;">อนุมัติ 1</span> ';
                        } else {
                            approver1 = '<span style="background-color: #dc3545; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px;">อนุมัติ 1</span> ';
                        }

                        var approver2 = '';
                        if (state.approver2 !== null && state.approver2 !== '') {
                            approver2 = '<span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px;">อนุมัติ 2</span> ';
                        } else {
                            approver2 = '<span style="background-color: #dc3545; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px;">อนุมัติ 2</span> ';
                        }

                        // รวมทั้งสอง status
                        $state.html(docNo + ' - ' + approver1 + approver2 + approveStatus);

                        return $state;
                    },
                    escapeMarkup: function (markup) {
                        return markup; // สำคัญ! ต้องมีเพื่อให้ HTML render ได้
                    }
                });
              

            }
        });
    }

    $.ajax({
        type: "GET",
        url: "././module/APP_STORE_WITHDRAW/data.php",
        dataType: "json",
        data: { load: "GetItem" },
        success: function (data) {
            let city = [{ id: '', text: '' }].concat(data.map((item) => ({
                id: item.item,
                text: item.item + ' - ' + item.description
            })));

            $("#item_w").select2({
                placeholder: 'กรุณาเลือก Item',
                allowClear: true,
                width: '100%',
                data: city,
                language: {
                    noResults: function () {
                        return "ไม่พบข้อมูล";
                    }
                }
            }).on('select2:select', function (e) {
                console.log(e.target.value);
                var um = data.filter((item) => item.item == e.target.value)[0].u_m;
                $("#um_w").val(um);



            });

            $("#item_w_edit").select2({
                placeholder: 'กรุณาเลือก Item',
                allowClear: true,
                width: '100%',
                data: city,
                language: {
                    noResults: function () {
                        return "ไม่พบข้อมูล";
                    }
                }
            }).on('change', function (e) {
                console.log(e.target.value);
                var um_edit = data.filter((item) => item.item == e.target.value)[0]?.u_m || '';
                $("#um_w_edit").val(um_edit);
            })
        }
    });

    var wc = [];

    $.ajax({
        type: "GET",
        url: "././module/APP_STORE_WITHDRAW/data.php",
        dataType: "json",
        data: { load: "GetDept" },
        success: function (data) {
            let city = [{ id: '', text: '' }].concat(data.map((item) => ({
                id: item.wc,
                text: item.wc + ' ' + item.description
            })));
            wc = city;
            $("#wc_dest").select2({
                placeholder: 'กรุณาเลือกนำไปใช้',
                allowClear: true,
                width: '100%',
                data: city,
                language: {
                    noResults: function () {
                        return "ไม่พบข้อมูล";
                    }
                }
            });

            $("#wc_dest_edit").select2({
                placeholder: 'กรุณาเลือกนำไปใช้',
                allowClear: true,
                width: '100%',
                data: city,
                language: {
                    noResults: function () {
                        return "ไม่พบข้อมูล";
                    }
                }
            });
        }
    });


    var table = $('#tbItemWithdraw').DataTable({
        "columnDefs": [
            { "targets": '_all', "className": 'text-center' },
        ],
        columns: [
            { "data": "item" },
            { "data": "itemDesc" },
            { "data": "qty_wd" },
            { "data": "qty_rcvd" },
            { "data": "u_m" },
            { "data": "wc_dest"
                , "render": function (data, type, row) {
                    var w = wc.filter((item) => item.id == data)
                    return w[0]?.text || '';
                }
             },
            { "data": "remark" },
        ],
        paging: false,
        searching: false,
        select: true,
  
        scrollX: true,
        scrollCollapse: true,
        dom:
            "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'lf>>" +
            "<'row'<'col-md-12'tr>>" +
            "<'row'<'col-md-5 text-left'i><'col-sm-7 text-right'p>>",
        buttons: [
            {
                text: `<button type="button" class="btn btn-warning">Edit</button>`,
                action: function (e, dt, node, config) {
                    var select = dt.rows('.selected').data().toArray();
                    var rowIndex = dt.rows('.selected').indexes()[0];
                    var approve_one = $("#approve_one").text();
                    var approve_two = $("#approve_two").text();

                    console.log(select);


                    if (select.length == 0) {
                        swal("กรุณาเลือกรายการที่ต้องการแก้ไข", "", "warning");
                        return false;
                    }


                    if (approve_two != 'อนุมัติ 2') {
                        swal("ไม่สามารถแก้ไขได้ เนื่องจากอนุมัติแล้ว", "", "warning");
                        return false;
                    }


                    $("#item_w_edit").val(select[0].item).trigger('change');
                    $("#qty_w_edit").val(select[0].qty_wd);
                    $("#wc_dest_edit").val(select[0].wc_dest).trigger('change');
                    $("#remark_w_edit").val(select[0].remark);
                    $("#doc_no_w_edit").val(select[0].doc_no);
                    $("#line_id_w_edit").val(select[0].line_id);
                    $("#row").val(rowIndex);
                    $("#ModalWithdraw").modal("show");

                }
            },
             {
                text: `<button type="button" class="btn btn-danger">Delete</button>`,
                action: function (e, dt, node, config) {
                    var all = dt.rows().data().toArray();
                    var select = dt.rows('.selected').data().toArray();
                    var rowIndex = dt.rows('.selected').indexes()[0];
                    var approve_one = $("#approve_one").text();
                    var approve_two = $("#approve_two").text();

                    if (all.length == 1) {
                        alert('ใบเบิกเดียวนี้มีรายการอยู่ 1 รายการ ไม่สามารถลบได้');
                        return false;
                    }

        
                    if (select.length == 0) {
                        swal("กรุณาเลือกรายการที่ต้องการแก้ไข", "", "warning");
                        return false;
                    }


                    if (approve_two != 'อนุมัติ 2') {
                        swal("ไม่สามารถแก้ไขได้ เนื่องจากอนุมัติแล้ว", "", "warning");
                        return false;
                    }

                    $.confirm({
                        title: 'ยืนยันลบรายการ',
                        theme: 'modern',
                        buttons: {
                            confirm: function () {
                                $.ajax({
                        type: "POST",
                        url: "././module/APP_STORE_WITHDRAW/data.php",
                        dataType: "json",
                        data: { load: "DeleteItemWithdraw", doc_no: select[0].doc_no, line_id: select[0].line_id },
                        success: function (data) {
                                alert('ลบรายการสําเร็จ');
                                dt.row(rowIndex).remove().draw();
                        },
                        error: function (xhr, status, error) {
                            alert('Error');
                        }
                        
                    });
                            },
                            cancel: function () {
                            }
                        }
                    });
                }
            },
            {
                text: `<button type="button" class="btn btn-info">พิมพ์ใบเบิก</button>`,
                action: function (e, dt, node, config) {
                    makePDF();
                }
            }
        ],
    });

    $('#btnAddItemWithdraw').click(function () {
        // add data to table 
        let doc_no = $("#doc_no_w_old").val();
        let item = $("#item_w").val();
        // split first - and get all remain
        let desc = $("#item_w option:selected").text().split('-').slice(1).join('-');
        let qty = $("#qty_w").val();
        let u_m = $("#um_w").val();
        let wc_dest = $("#wc_dest").val();
        let remark = $("#remark_w").val();

        if (item == '') {
            swal("กรุณาระบุ Item", "", "warning");
            return false;
        } else if (qty == '') {
            swal("กรุณาระบุ จํานวน", "", "warning");
            return false;
        } else if (wc_dest == '') {
            swal("กรุณาระบุ แผนกปลายทาง", "", "warning");
            return false;
        }

        if (doc_no != '') {
            $.ajax({
                type: "POST",
                url: "././module/APP_STORE_WITHDRAW/data.php",
                dataType: "json",
                data: {
                    load: "AddNewItemWithdraw",
                    doc_no: doc_no,
                    item: item,
                    qty: qty,
                    wc_dest: wc_dest,
                    remark: remark
                },
                success: function (data) {
                    if (data == 1) {
                        alert("Doc No นี้ถูกใช้ไปแล้ว");
                        return false;
                    }

                    const newData = data.map((item) => ({
                        "itemDesc": desc,
                        "u_m": u_m,
                        ...item
                    }));
                    table.rows.add(newData).draw();
                }
            })
        } else {
            const newData = [{
                "item": item,
                "itemDesc": desc,
                "qty_wd": qty,
                "qty_rcvd": null,
                "u_m": u_m,
                "wc_dest": wc_dest,
                "remark": remark
            }]
            console.log(newData);
            

            table.rows.add(newData).draw();
        }



        // clear form
        $("#item_w").val('').trigger('change');
        $("#wc_dest").val('').trigger('change');
        $("#qty_w").val('');
        $("#remark_w").val('');
    });

    $("#btnResetWithdraw").click(function () {
        table.clear().draw();
        $("#item_w").val('').trigger('change');
        $("#wc_dest").val('').trigger('change');
        $("#qty_w").val('');
        $("#remark_w").val('');
        $("#doc_no_w").val('').trigger('change');
        $("#doc_no_w_old").val('');
        $("#dept_w").val('').trigger('change');
        $("#remark_withdraw").val('');

        $("#btnAddWithdraw").attr("disabled", false);
        $("#btnUpdateW").attr("disabled", true);
        $("#btnAddItemWithdraw").attr("disabled", false);
        $("#approve_user").hide();

        $("#approve_one").text("อนุมัติ 1");
        $("#approve_one").attr("disabled", true)

        $("#approve_two").text("อนุมัติ 2");
        $("#approve_two").attr("disabled", true)
        $("#user_w").val(username_session);
        // show approve button

    });

    $("#btnSearchBooking").click(function () {
        var doc_no = $("#doc_no_w").val();

        if (doc_no == '') {
            swal("กรุณาระบุ Doc No", "", "warning");
            return false;
        }

        $.ajax({
            type: "GET",
            url: "././module/APP_STORE_WITHDRAW/data.php",
            dataType: "json",
            data: {
                load: "GetWithdrawByDocNo",
                doc_no: doc_no
            },
            success: function (data) {

                table.clear();
                table.rows.add(data).draw();

                $("#dept_w").val(data[0].dept).trigger('change');
                $("#remark_withdraw").val(data[0].remark_h);


                if (data[0].approver1 !== null) {
                    $("#approve_one").text("อนุมัติ 1 แล้ว");
                    $("#approve_one").attr("disabled", true);
                } else {
                    $("#approve_one").text("อนุมัติ 1");
                    $("#approve_one").attr("disabled", false);
                }

                if (data[0].approver2 !== null) {
                    $("#approve_two").text("อนุมัติ 2 แล้ว");
                    $("#approve_two").attr("disabled", true);
                } else {
                    $("#approve_two").text("อนุมัติ 2");
                    $("#approve_two").attr("disabled", false);
                }

                if (data[0].userApprove !== null) {
                    $("#approve_user").text("รับของแล้ว");
                    $("#approve_user").prop("disabled", true);
                    $("#approve_user").show();
                } else {
                    // change display
                    $("#approve_user").show();
                    $("#approve_user").text("รับของ");
                    $("#approve_user").prop("disabled", false);
                }

                if (data[0].approver1 !== null || data[0].approver2 !== null) {
                    $("#btnAddItemWithdraw").attr("disabled", true);
                } else {
                    $("#btnAddItemWithdraw").attr("disabled", false);
                }

                 var username_session_trim = username_session.trim().toLowerCase();
                 if (userApproveTwo.map(x => x.trim().toLowerCase()).includes(username_session_trim) && data[0].userApprove == null) {
                   $("#approve_two").attr("disabled", false);
                 }

                $("#item_w").val('').trigger('change');
                $("#wc_dest").val('').trigger('change');
                $("#user_w").val(data[0].user_hdr);
                $("#qty_w").val('');
                $("#remark_w").val('');
                $("#doc_no_w_old").val(data[0].doc_no);

                //

                // disable button
                $("#btnAddWithdraw").attr("disabled", true);
                $("#btnUpdateW").attr("disabled", false);
                //$("#btnAddItemWithdraw").attr("disabled", true);
                data_withdraw = data;

            },
            error: function (xhr, status, error) {
                alert('Error');
            }
        });
    });


    $('#btnAddWithdraw').click(function () {
        // add data to table 
        var dept = $("#dept_w").val();
        var user = $("#user_w").val();
        var remark_h = $("#remark_withdraw").val();
        var item = [];
        var qty = [];
        var wc_dest = [];
        var remark = [];

        // get data from table #tbItemWithdraw
        table.rows().data().each(function (data, index) {
            item.push(data.item);
            qty.push(data.qty_wd);
            wc_dest.push(data.wc_dest);
            remark.push(data.remark);
        });

        if (item.length == 0) {
            swal("กรุณากรอกรายการ Item ที่ต้องการเบิก อย่างน้อย 1 รายการ", "", "warning");
            return false;
        }
   
        $("#btnAddWithdraw").attr("disabled", true);

        $.ajax({
            type: "POST",
            url: "././module/APP_STORE_WITHDRAW/data.php",
            dataType: "json",
            data: {
                load: "CreateWithdraw",
                dept: dept,
                user: user,
                remark_h: remark_h,
                item: JSON.stringify(item),
                qty: JSON.stringify(qty),
                wc_dest: JSON.stringify(wc_dest),
                remark: JSON.stringify(remark)
            },
            success: function (data) {

                alert("บันทึกข้อมูลสําเร็จ เลขที่ใบเบิก: " + data);
                table.clear().draw();
                $("#item_w").val('').trigger('change');
                $("#wc_dest").val('').trigger('change');
                $("#qty_w").val('');
                $("#remark_w").val('');
                $("#doc_no_w").val('').trigger('change');
                $("#dept_w").val('').trigger('change');
                $("#remark_withdraw").val('');

                $("#btnUpdateW").attr("disabled", true);
                $("#btnAddItemWithdraw").attr("disabled", false);
                $("#approve_user").hide();
                getDocNumList();
            }
        });
    });

    function SaveWithdrawItem() {
        var doc_no = $("#doc_no_w_edit").val();
        var line_id = $("#line_id_w_edit").val();
        var item = $("#item_w_edit").val();
        var desc = $("#item_w_edit option:selected").text().split('-').slice(1).join('-');
        var qty = $("#qty_w_edit").val();
        var u_m = $("#um_w_edit").val();
        var wc_dest = $("#wc_dest_edit").val();
        var remark = $("#remark_w_edit").val();

        if (doc_no == '') {
            swal("กรุณาระบุเลขที่ใบเบิก", "", "warning");
            return false;
        }

        if (item == '') {
            swal("กรุณาระบุ Item", "", "warning");
            return false;
        } else if (qty == '') {
            swal("กรุณาระบุ จํานวน", "", "warning");
            return false;
        } else if (wc_dest == '') {
            swal("กรุณาระบุ แผนกปลายทาง", "", "warning");
            return false;
        }

        $.ajax({
            type: "POST",
            url: "././module/APP_STORE_WITHDRAW/data.php",
            dataType: "json",
            data: {
                load: "UpdateWithdrawItem",
                doc_no: doc_no,
                line_id: line_id,
                item: item,
                qty: qty,
                wc_dest: wc_dest,
                remark: remark
            },
            success: function (data) {

                $("#item_w_edit").val('').trigger('change');
                $("#wc_dest_edit").val('').trigger('change');
                $("#qty_w_edit").val('');
                $("#remark_w_edit").val('');
                $("#item_w_edit_old").val('');
                $("#wc_dest_edit_old").val('');
                $("#ModalWithdraw").modal("hide");
                // update table cell
                table.cell($("#row").val(), 0).data(item);
                table.cell($("#row").val(), 1).data(desc);
                table.cell($("#row").val(), 2).data(qty);
                table.cell($("#row").val(), 4).data(u_m);
                table.cell($("#row").val(), 5).data(wc_dest);
                table.cell($("#row").val(), 6).data(remark);
                swal("แก้ไขข้อมูลสําเร็จ", "", "success");
            }
        });

    }

    $('#btnUpdateW').click(function () {
        // add data to table #tbItemWithdraw
        var doc_no = $("#doc_no_w_old").val();
        var dept = $("#dept_w").val();
        var remark = $("#remark_withdraw").val();

        if (doc_no == '') {
            swal("กรุณาระบุเลขที่ใบเบิก", "", "warning");
            return false;
        }

        if (dept == '') {
            swal("กรุณาระบุแผนก", "", "warning");
            return false;
        }
        
        $.ajax({
            type: "POST",
            url: "././module/APP_STORE_WITHDRAW/data.php",
            dataType: "json",
            data: {
                load: "UpdateWithdrawHeader",
                doc_no: doc_no,
                dept: dept,
                remark: remark

            },
            success: function (data) {
                swal("อัปเดตข้อมูลสําเร็จ", "", "success");
            }
        });
    });

    function approve_user() {

        if ($("#doc_no_w_old").val() == '' || $("#dept_w").val() == '') {
            swal("กรุณาเลือก Doc No", "", "warning");
            return false;
        }

        if (data_withdraw[0].user_hdr.trim().toLowerCase() != username_session.trim().toLowerCase()) {
            swal("ไม่สามารถรับของได้ ผู้เปิดใบเบิกต้องเป็นผู้รับของ!", "", "warning");
            return false;
        }

        for (var i = 0; i < data_withdraw.length; i++) {
            if (data_withdraw[i].qty_rcvd == null) {
                swal("ไม่สามารถรับของได้ เนื่องจากทางคลังยังไม่ได้กรอกจํานวนที่เบิกได้", "", "warning");
                return false;
            }
        }


        $.confirm({
            title: 'ยืนยันรับของ',
            theme: 'modern',
            buttons: {
                confirm: function () {
                    var approve = $("#i_user").val();

                    $.ajax({
                        type: "POST",
                        url: "././module/APP_STORE_WITHDRAW/data.php",
                        dataType: "json",
                        data: {
                            load: "ApproveUserWithdraw",
                            doc_no: $("#doc_no_w").val(),
                        },
                        success: function (data) {
                            swal("รับของสําเร็จ", "", "success");
                            // edit text btn approve_stock
                            $("#approve_user").text("รับของแล้ว");
                            $("#approve_user").attr("disabled", true);
                        },
                        error: function (xhr, status, error) {
                            alert('Error');
                        }
                    });

                },
                cancel: function () {
                    window.close();
                }

            }
        });

    }

    function approve_one() {

        if ($("#doc_no_w").val() == '' || $("#dept_w").val() == '') {
            swal("กรุณาเลือก Doc No", "", "warning");
            return false;
        }

        // both lower case and upper case and remove space front and back
        var username_session_trim = username_session.trim().toLowerCase();
        if (!userApproveOne.map(x => x.trim().toLowerCase()).includes(username_session_trim)) {
            swal("คุณไม่มีสิทธิ์อนุมัติ", "", "warning");
            return false;
        }


        $.confirm({
            title: 'อนุมัติ 1 โดย',
            theme: 'modern',
            content: '<input placeholder="ผู้อนุมัติ" type="text" id="i_approve_one" class="form-control my-2" value="' + username_session + '" readonly>',
            buttons: {
                confirm: function () {
                    var approve = $("#i_approve_one").val();

                    $.ajax({
                        type: "POST",
                        url: "././module/APP_STORE_WITHDRAW/data.php",
                        dataType: "json",
                        data: {
                            load: "ApproveOneWithdraw",
                            doc_no: $("#doc_no_w").val(),
                            approve: approve
                        },
                        success: function (data) {
                            swal("อนุมัติ 1 สําเร็จ", "", "success");
                            // edit text btn approve_one
                            $("#approve_one").text("อนุมัติ 1 แล้ว");
                            $("#approve_one").attr("disabled", true);
                            $("#btnAddItemWithdraw").attr("disabled", true);
                        },
                        error: function (xhr, status, error) {
                            alert('Error');
                        }
                    });

                },
                cancel: function () {
                    window.close();
                }

            }
        });

    }

    function approve_two() {

        var load = 'ApproveTwoWithdraw';

        if ($("#doc_no").val() == '' || $("#dept_w").val() == '') {
            alert("กรุณาเลือก Doc No");
            return false;
        }

        var username_session_trim = username_session.trim().toLowerCase();
        if (!userApproveTwo.map(x => x.trim().toLowerCase()).includes(username_session_trim)) {
            swal("คุณไม่มีสิทธิ์อนุมัติ", "", "warning");
            return false;
        }

        if ($("#approve_two").text().trim() === 'อนุมัติ 2 แล้ว') {
            load = 'CancelApproveTwoWithdraw';
        }


        $.confirm({
            title: 'อนุมัติ 2 โดย',
            theme: 'modern',
            content: '<input placeholder="ผู้อนุมัติ" type="text" id="i_approve_two" class="form-control my-2" value="' + username_session + '" readonly>',
            buttons: {
                confirm: function () {
                    var approve = $("#i_approve_two").val();

                    $.ajax({
                        type: "POST",
                        url: "././module/APP_STORE_WITHDRAW/data.php",
                        dataType: "json",
                        data: {
                            load: load,
                            doc_no: $("#doc_no_w").val(),
                            approve: approve
                        },
                        success: function (data) {
                            if (load == 'ApproveTwoWithdraw') {
                                swal("อนุมัติ 2 สําเร็จ", "", "success");
                            // edit text btn approve_two
                            $("#approve_two").text("อนุมัติ 2 แล้ว");
                            $("#approve_two").attr("disabled", true);
                            $("#btnAddItemWithdraw").attr("disabled", true);
                            } else {
                                alert('ยกเลิกอนุมัติ 2 สําเร็จ');
                                  $("#approve_two").text("อนุมัติ 2");
                                  $("#approve_two").attr("disabled", false);
                                  $("#btnAddItemWithdraw").attr("disabled", false);
                            }
                        },
                        error: function (xhr, status, error) {
                            alert('Error');
                        }
                    });

                },
                cancel: function () {
                    window.close();
                }

            }
        });

    }

    function makePDF(newData) {

        pdfMake.fonts = {
            THSarabunNew: {
                normal: 'THSarabunNew.ttf',
                bold: 'THSarabunNew Bold.ttf',
                italics: 'THSarabunNew-Italic.ttf',
                bolditalics: 'THSarabunNew-BoldItalic.ttf'
            },
            FontAwesome: {
                normal: 'fontawesome-webfont.ttf',
            }
        };

        const logo = () => {
            let img = 'data:image/jpeg;base64,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'
            return img;
        }
        // how to cal 10% from totalTax

        const data = [];
        console.log(data_withdraw);


        data.push([
            { text: 'รายการ', fontSize: 18, bold: true, alignment: 'center' },
            { text: 'รายละเอียด', fontSize: 18, bold: true, alignment: 'center' },
            { text: 'ขอเบิก', fontSize: 18, bold: true, alignment: 'center' },
            { text: 'เบิกได้', fontSize: 18, bold: true, alignment: 'center' },
            { text: 'นำไปใช้', fontSize: 18, bold: true, alignment: 'center' },
        ])

        for (let i = 0; i < data_withdraw.length; i++) {
            data.push([
                { text: data_withdraw[i].item, fontSize: 13, alignment: 'center' },
                { text: data_withdraw[i].itemDesc ? data_withdraw[i].itemDesc : '', fontSize: 13, alignment: 'center' },
                { text: data_withdraw[i].qty_wd ? data_withdraw[i].qty_wd : '', fontSize: 13, alignment: 'center' },
                { text: '', fontSize: 13, alignment: 'center' },
                { text: `${data_withdraw[i].wc_dest}  ${data_withdraw[i].wcDestDesc ? data_withdraw[i].wcDestDesc : ''}`, fontSize: 13, alignment: 'center' },
            ])
        }

        var docDefinition = {
            pageSize: 'A4',

            pageMargins: [10, 140, 50, 150],
            header: function (currentPage, pageCount, pageSize) {
                return {
                    margin: [20, 20, 20, 10],
                    stack: [
                        {
                            columns: [
                                { text: "ใบเบิกของ", fontSize: 30, bold: true, alignment: 'center', margin: [0, 0, 0, 0] },
                            ],
                            margin: [0, 5, 0, 0]
                        },
                        {
                            columns: [
                                { text: `วันที่ : ${new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' })}`, fontSize: 18, bold: true, alignment: 'left', margin: [0, 2, 0, 0] },
                                { image: generateBarcode(data_withdraw[0].doc_no), width: 130, height: 30, alignment: 'center' },
                            ]
                        },
                        {
                            columns: [
                                { text: `แผนก : ${data_withdraw[0].dept}`, fontSize: 18, bold: true, alignment: 'left', margin: [0, 2, 0, 0] },
                                { text: `เลขที่เอกสาร : ${data_withdraw[0].doc_no}`, fontSize: 18, bold: true, alignment: 'right', margin: [0, 2, 0, 0] },
                            ]
                        }
                    ]
                };
            },
            footer: function (currentPage, pageCount) {
                return {
                    margin: [10, 0, 0, 0],
                    table: {
                        widths: [150, 200, 200, 200],
                        body: [
                            [
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    colSpan: 2,
                                    text: "ผู้จ่าย..................................................",
                                    alignment: "left",

                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    text: ``,
                                    alignment: "center",
                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    text: `ผู้เบิก..............${data_withdraw[0].user_hdr}................`,
                                    alignment: "center",
                                }
                            ],
                            [
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    colSpan: 2,
                                    text: "ตัดสต๊อก..................................................",
                                    alignment: "left",

                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    text: ``,
                                    alignment: "center",
                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    text: `อนุมัติโดย.............${data_withdraw[0].approver2 ?? '..........'}............`,
                                    alignment: "center",
                                }
                            ],
                            [
                                {
                                    border: [false, false, false, false],
                                    fontSize: 18,
                                    bold: true,
                                    text: "FOMPC-07 / 07-APR-01",
                                    alignment: "center",


                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 14,
                                    text: ``,
                                    alignment: "center",
                                },
                                {
                                    border: [false, false, false, false],
                                    fontSize: 14,
                                    text: ``,
                                    alignment: "center",
                                }
                            ]
                        ]
                    }
                };

            },
            content: [
                {
                    margin: [0, 0, 0, 0],
                    columns: [
                        {

                            table: {
                                widths: [50, 180, 60, 60, 180],
                                headerRows: 1,
                                body: data,
                            },
                        },
                    ],
                }
            ],
            defaultStyle: {
                font: 'THSarabunNew',
            },
        };

        pdfMake.createPdf(docDefinition).open()

    }


</script>
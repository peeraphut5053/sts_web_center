<style>
  .col-search {
    padding-left: 3px;
    padding-right: 3px;
  }
  /*    table.dataTable thead .sorting:after,
        table.dataTable thead .sorting:before,
        table.dataTable thead .sorting_asc:after,
        table.dataTable thead .sorting_asc:before,
        table.dataTable thead .sorting_asc_disabled:after,
        table.dataTable thead .sorting_asc_disabled:before,
        table.dataTable thead .sorting_desc:after,
        table.dataTable thead .sorting_desc:before,
        table.dataTable thead .sorting_desc_disabled:after,
        table.dataTable thead .sorting_desc_disabled:before {
            bottom: .5em;
        }*/
  .table thead th {
    text-align: center;
  }

  .col-flt-page {
    padding-top: 10px;
    font-weight: bold;
  }

  #tblReportMonth tbody tr td a {
    cursor: pointer;
  }
  table.dataTable.fixedHeader-floating,
  table.dataTable.fixedHeader-locked {
    background-color: white;
    margin-top: 50px !important;
    margin-bottom: 0 !important;
  }
  @media print {
    table th:nth-child(0) {
      width: 200px;
      word-break: break-all;
      white-space: pre-line;
    }
    table td:nth-child(0) {
      width: 200px;
      word-break: break-all;
      white-space: pre-line;
    }
  }
  .text-header {
    font-weight: bold;
    font-size: 20px;
  }
  .text-wrap {
    white-space: normal;
  }
  .width-200 {
    width: 200px;
  }
  input[type="checkbox"] {
    margin-left: 5px;
    margin-right: 5px;
  } /*
    .cb_lb{
        margin-top:-5px;
    }*/
  .item-center {
    display: flex;
    justify-content: center;
  }

   .bolded {
    font-weight: bold;
  }
</style>
<div class="row">
  <h4 class="text-header text-center"></h4>
</div>
<div class="row item-center">
  <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
    <div class="input-group w-full">
        <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">Type *</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="type_month">
                    <option value="amount">Amount</option>
                    <option value="kg">Kg</option>
                </select>
    </div>
  </div>
  <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
    <div class="input-group w-full">
      <div style="font-weight: bold; font-size: 16px;" class="input-group-addon">Year</div>
                <select style="font-weight: bold; font-size: 16px;" class="form-control txt-filter"
                    id="sale_month">
                </select>
    </div>
  </div>
  <div class="col-lg-1 col-md-1 col-sm-6 col-xs-6 text-left">
    <button class="btn btn-info" id="btnSearchMonth">
      <i class="fa fa-search"></i>&nbsp; Search
    </button>
  </div>
</div>

<div class="row" id="rowResultTable">
  <table
    class="table table-condensed table-bordered table-striped"
    width="100%"
    id="tblReportMonth"
  >
    <thead>
      <tr>
        <!--<th >#</th>-->
        <th class="bg-gray">Name</th>
        <th class="bg-gray">Jan</th>
        <th class="bg-gray">Feb</th>
        <th class="bg-gray">Mar</th>
        <th class="bg-gray">Apr</th>
        <th class="bg-gray">May</th>
        <th class="bg-gray">Jun</th>
        <th class="bg-gray">Jul</th>
        <th class="bg-gray">Aug</th>
        <th class="bg-gray">Sep</th>
        <th class="bg-gray">Oct</th>
        <th class="bg-gray">Nov</th>
        <th class="bg-gray">Dec</th>
      </tr>
    </thead>
    <!--        <tbody id="tblReportMonthList">
                    <tr><td align="center" colspan="12">.... No item search ....</td></tr>
                </tbody>-->
  </table>
</div>
<script type="text/javascript">

  var startYear = 2020;
  var endYear = moment().year();

  // create options for select
  var options = Array.from({
    length: endYear - startYear + 1,
  }).map((value, index) => {
    var year = startYear + index;
    return `<option value="${year}">${year}</option>`;
  });

  // add options to select
  $("#sale_month").append(options);
  $("#sale_month").val(endYear);
  
  $("#btnSearchMonth").click(function () {
    ReportItemSearch();
  });

  function ReportItemSearch() {
      var OldHtml = $("#btnSearchMonth").html();
      var type = $("#type_month").val();

      $("#btnSearchMonth").html("<i class='fa fa-spinner fa-spin'></i>");
      $("#tblReportMonth").loading();
      $("#tblReportMonth tfoot").remove();
      $.ajax({
        type: "GET",
        url: "././module/RPT_SALES_PERSONS/data.php",
        dataType: "json",
        beforeSend: function () {
          $("#btnSearchMonth").html("<i class='fa fa-spinner fa-spin'>");
        },
        data: {
          load: "GetSalesByMonth",
          type: type,
          year: $("#sale_month").val(),
        },
        success: function (data) {
          $("#tblReportMonth").DataTable().clear();
          $("#tblReportMonth").append(
            "<tfoot><tr></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></td></tr></tfoot>"
          );
          $("#tblReportMonth").dataTable({
            aaData: data,
            paging: false,
            fixedHeader: true,
            destroy: true,
            processing: true,
            scrollY: "65vh",
            scrollCollapse: true,
            scrollX: true,
            columnDefs: [{}],
            columns: [
              {
                data: "name",
                className: "text-center"
              },
              {
                data: "JAN",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "FEB",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "MAR",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "APR",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "MAY",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "JUN",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "JUL",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "AUG",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "SEP",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "OCT",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "NOV",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
              {
                data: "DEC",
                className: "text-center",
                render: function (data, type, row) {
                  if (data == null) {
                    return "-";
                  } else {
                    return addCommas(data);
                  }
                }
              },
    
            ],
            dom:
              "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'lf>>" +
              "<'row'<'col-md-12'tr>>" +
              "<'row'<'col-md-5 text-left'i><'col-sm-7 text-right'p>>",
            buttons: [
              {
                extend: "print",
                text: "<i class='fa fa-print'></i>&nbsp;Print",
                title: "",
              },
              {
                extend: "excel",
                footer: true,
                text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                title: "รายงานยอดขาย By Sales Person " + GetCurrDateTime(),
              }
            ],
          });

          $("#tblReportMonth").loading("stop");
          $("#btnSearchMonth").html(OldHtml);
        },
        error: function (e) {
          $("#tblReportMonth").loading("stop");
          $("#btnSearchMonth").html(OldHtml);
          console.log("There was an error with your request...");
          console.log("error: " + JSON.stringify(e));
        },
      });
    }
</script>

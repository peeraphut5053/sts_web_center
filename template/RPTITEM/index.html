<style>
    .col-search{
        padding-left:3px;
        padding-right:3px;
    }
    .table thead th{
        text-align: center;
    }

    .col-flt-page{
        padding-top:10px;
        font-weight: bold;
    }

    #tblReport tbody tr td a {
        cursor: pointer ;
    }
    table.dataTable.fixedHeader-floating, table.dataTable.fixedHeader-locked {
        background-color: white;
        margin-top: 50px !important;
        margin-bottom: 0 !important;
    }
    .input-group .input-group-addon {
        width: 70px; 
    }
</style>
<div class="row">
    <h3 style="padding-left:10px;"> รายงาน Item </h3>
</div>
<div class='row'>
    <div class="col-md-4  col-search"  >
        <div class="input-group w-full">
            <div class="input-group-addon">Item</div>
            <input type="text" class="form-control txt-filter" id="txtItem" >
        </div>
    </div>
    <!--    <div class="col-md-2 col-search">
            <div class="input-group">
                <div class="input-group-addon">Description</div>
                <input type="text" class="form-control txt-filter" id="txtItemDesc">
            </div>
        </div>-->
    <div class="col-md-2 col-search"  >
        <!--        <div class="row">
                    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 text-right">
                        <input type="radio" onclick="RadioClick(this.id);"  id="radSize1" name="radSize" value="1" >
                    </div>
                    <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">   
                        <div class="input-group">
                            <div class="input-group-addon">ขนาด(เลือก)</div>
                            <select class="form-control" id="selSize">
                                {size_list}
                            </select>
                        </div>
                    </div>     
                </div>-->
        <!--            <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 text-right">
                        <input type="radio" onclick="RadioClick(this.id);" id="radSize2" name="radSize" value="2">
                    </div>-->
        <div class="input-group">
            <div class="input-group-addon">ขนาด</div>
            <input type="text" class="form-control txt-filter" id="txtSize" >
        </div>
        
    </div>
    
   <!-- <div class="col-md-6 col-search"  >
        <div class="input-group">
            <div class="input-group-addon">หนา</div>
            <input type="text" class="form-control txt-filter" id="txtThick" >          
        </div>
    </div>
    <div class="col-md-6 col-search" >
        <div class="input-group">
            <div class="input-group-addon">ยาว</div>
            <input type="text" class="form-control txt-filter" id="txtWidth" >

        </div>
    </div>
    <div class="col-md-3 col-sm-6 col-xs-12  col-search">
        <div class="row" style="padding-left:15px;">
            <div class="col-lg-2 col-md-2 col-sm-6 col-xs-2  col-search text-right">
                สต็อค
            </div>
            <div class="col-lg-10 col-md-10 col-sm-10 col-xs-10  col-search">
                <input type="radio" style="width:25px;" checked name="radSearch" id="radSearch" value="0" >&nbsp;ทั้งหมด
                <input type="radio"  name="radSearch" id="radSearch" value="1" >&nbsp;มีในสต็อค
                <input type="radio" name="radSearch" id="radSearch" value="2" >&nbsp;ไม่มีในสต็อค
            </div>
        </div>
        <div class="row" style="padding-left:15px;">
            <div class="col-lg-2 col-md-2 col-sm-6 col-xs-2  col-search text-right">
                ปี
            </div>
            <div class="col-lg-10 col-md-10 col-sm-10 col-xs-10  col-search">
                <input type="radio" style="width:25px;" checked name="radYear" id="radSearch" value="" >&nbsp;ทั้งหมด
                <!--            <input type="radio"  name="radYear" id="radYear" value="2018" >&nbsp;2018
                            <input type="radio" name="radYear" id="radYear" value="2019" >&nbsp;2019 
                {year_list}
            </div>



        </div>
    </div> -->
    <div class="col-md-4 col-search">
          <div class="col-md-1 col-lg-1 col-sm-6 col-xs-12 col-search text-center">
        <div class="row">
            <button  id="btnSearch" class="btn btn-info"><i class="fa fa-search"></i>&nbsp;ค้นหา</button>
            <!--<button id="btnExportExcel" class="btn btn-success"><i class="fa fa-download"></i>&nbsp;Export Excel</button>-->
        </div>
    </div>
    </div>
</div>


<!--<div class="row">
    
    <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 text-right"> 
        <div class="row" style="padding-right:15px;padding-top:10px;">
            เลือกคลัง (เลือกได้มากกว่า 1 คลัง)
        </div>
    </div>
    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
        <div class="row">
            <select class="form-control" id="selWH"  multiple="multiple" style="display:none;" disabled>
                <option value="ALL" selected>ทั้งหมด</option>
                {options_warehouse}
            </select>
        </div>

    </div>
    
</div>-->


<!--<div class="alert alert-warning text-center">
    <h5>กำลังดำเนินการแก้ไข เพื่อให้จำนวนสินค้าระหว่างขาย , ระหว่างส่ง , ส่งแล้ว  แยกจำนวนตามคลังได้ </h5>
    <h5 style="color:green;font-weight: bold;">สถานะการแก้ไข : รอเช็คความถูกต้อง</h5>
</div>-->
<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="divShowPrint" style='padding:0px !important' >
        <table width="100%" class="table table-condensed table-bordered table-striped" id="tblReport">
            <thead>
                <tr>
                    <th>#</th>
                    <th >Item/Description</th>
                    <th >ขนาด</th>
                    <th >หนา</th>
                    <th >ยาว</th>
                    <th >เส้น/มัด</th>
                    <th >น.น.ผลิต (ก.ก.)</th>
                    <!--<th >ที่เก็บ</th>-->
                    <th >สต็อคคงเหลือ(เส้น)</th>
                    <th>สินค้าระหว่างขาย(เส้น)</th>
                    <!-- <th>สินค้าระหว่างส่ง(เส้น)</th>  -->
                    <!--<th>ส่งเรียบร้อย(เส้น)</th>-->
                </tr>

            </thead>
            <tbody id="tblReportList">
                <!--<tr><td align="center" colspan="12">.... No item search ....</td></tr>-->
            </tbody>
        </table>
    </div>
</div>


<div class="modal" tabindex="-1" role="dialog" id="modalDetail" >
    <div class="modal-dialog" role="document" style="width:900px;">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row text-left">                    
                    <div class="col-md-10 col-lg-10 col-xs-10 col-sm-10 col-10">
                        <h4 class="modal-title" id="modalDetailHead">Modal Header</h4>
                    </div> 
                    <div class="col-md-2 col-lg-2 col-xs-2 col-sm-2 col-2">
                        <button type="button" style="width:25px;border-radius: 2px;color:white;background-color:red;" class="close" data-dismiss="modal">&times;</button>
                    </div>  
                </div>
            </div>
            <div class="modal-body" id="modalDetailBody">
                <table  id="tblModal" class='table table-striped table-condensed'>                  

                </table>
            </div>
        </div>
    </div>
</div>



<script type="text/javascript">
//     $("#selWH").select2();
//    $(document).ready(function () {
//
//        $('#selWH').selectize({
//            plugins: ['remove_button'],
//            delimiter: ',',
//            persist: false,
//            create: function (input) {
//                return {
//                    value: input,
//                    text: input
//                }
//            }
//        });
//    });
    $("#btnSearch").click(function () {
        ReportItemSearch();
    });
    $(".txt-filter").on("keypress", function (e) {
        if (e.keyCode == 13) {
            ReportItemSearch();
            return false; // prevent the button click from happening
        }
    });
//    $("#tblReport").css({"width": screen.width});
    function ReportItemSearch() {

        $('#tblReport').DataTable().destroy();
        var oldHtmlBtn = $("#btnSearch").html();
        $("#btnSearch").html("<i class='fa fa-spinner fa-spin'></i>");
        $('#tblReport').loading();
        var txtItem = $("#txtItem").val();
        var txtSize = $("#txtSize").val();
        var Locs = [];
        Locs = $("#selWH").val();

        $("#tblReportList").load("././module/RPTITEM/data.php", {
            "load": "ajax",
            "txtItem": txtItem,
            "txtSize": txtSize,
        }, function () {
            $("#btnSearch").html(oldHtmlBtn);
            $('#tblReport').DataTable({
                "scrollX": true,
                searching: true,
                "pageLength": 999999999,
                'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'>>" +
                        "<'row'<'col-md-12'tr>>" +
                        "<'row'<'col-md-5'><'col-sm-7'>>",
                buttons: [
                    {
                        extend: 'print',
                        text: "<i class='fa fa-print'></i>&nbsp;Print",
                        title: ''
                    },
                    {
                        extend: 'excel',
                        text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                        title: ''
                    },
                ]
            });
            var getAllRows = $(".table tbody tr").length;
            $('#tblReport').loading('stop');
        });
    }
    $("#btnExportExcel").click(function () {
        //        onclick="javascript:

        //       xport.toCSV('tblReport');
    });



    function ExportExcel() {
        var dt = new Date();
        var day = dt.getDate();
        var month = dt.getMonth() + 1;
        var year = dt.getFullYear();
        var hour = dt.getHours();
        var mins = dt.getMinutes();
        var postfix = day + "-" + month + "-" + year + "_" + hour + "-" + mins;
        var filename = 'SyteLine_Item_Report_' + postfix + '.xls';
        //        tablesToExcel(ArrId, ArrName, filename);
        tablesToExcel("tblReport", "text", filename);
    }



    function CheckQty(thisid) {
        $("#tblModal").empty();
        var datarow = thisid.split("!!")[1];
        var item = thisid.split("!!")[2];

        $("#modalDetail").modal("show");
        $("#modalDetailHead").html("<div class='row text-center'><h4><i class='fa fa-spinner fa-spin'></i></h4></div>");

        $.ajax({
            url: "./module/RPTITEM/data.php",
            type: 'post',
            data: {
                load: 'CheckQty',
                item: item,
//                loc: loc
            },
            success: function (data) {
                   $("#tblModal").empty();
                $("#modalDetailHead").text("ข้อมูล [" + item + "] สต็อค ");
                $("#tblModal").html(data);

                $('#tblModal').DataTable({
                    searching: true,
                    "scrollX": true,
                    fixedHeader: true,
                    retrieve: true,
                    "pageLength": 999999999,
                    'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'f>>" +
                            "<'row'<'col-md-12'tr>>" +
                            "<'row'<'col-md-5'><'col-sm-7'>>",
                    buttons: [
                        {
                            extend: 'print',
                            text: "<i class='fa fa-print'></i>&nbsp;Print",
                            title: ''
                        },
                        {
                            extend: 'excel',
                            text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                            title: ''
                        },
                    ]
                });
            },
            error: function (xhr, status, error) {
                $("#debug").html(xhr.responseText);
            },
            //            dataType: "json"
        });

        //        }



    }

    function BetweenSale(thisid) {
        $("#tblModal").empty();
        var datarow = thisid.split("!!")[1];
        var item = thisid.split("!!")[2];
        var loc = thisid.split("!!")[3];
        var atYear = $("input[name='radYear']:checked").val();
        $("#modalDetail").modal("show");
        $("#modalDetailHead").html("<div class='row text-center'><h4><i class='fa fa-spinner fa-spin'></i></h4></div>");

        $.ajax({
            url: "./module/RPTITEM/data.php",
            type: 'post',
            data: {
                load: 'BetweenSale',
                item: item,
                loc: loc,
                atYear: atYear
            },
            success: function (data) {
                $("#tblModal").empty();
                $("#modalDetailHead").text("ข้อมูล [" + item + "] LINE status = Ordered ");
                $("#tblModal").html(data);
                $('#tblModal').DataTable({
                    "scrollX": true,
                    searching: true,
                    fixedHeader: true,
                    retrieve: true,
                    "pageLength": 999999999,
                    'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'f>>" +
                            "<'row'<'col-md-12'tr>>" +
                            "<'row'<'col-md-5'><'col-sm-7'>>",
                    buttons: [
                        {
                            extend: 'print',
                            text: "<i class='fa fa-print'></i>&nbsp;Print",
                            title: ''
                        },
                        {
                            extend: 'excel',
                            text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                            title: ''
                        },
                    ]
                });
            },
            error: function (xhr, status, error) {
                $("#debug").html(xhr.responseText);
            },
            //            dataType: "json"
        });

        //        }



    }

    function Shipping(thisid) {
        $("#tblModal").empty();
        var datarow = thisid.split("!!")[1];
        var item = thisid.split("!!")[2];
        var loc = thisid.split("!!")[3];
        var atYear = $("input[name='radYear']:checked").val();
        $("#modalDetail").modal("show");
        $("#modalDetailHead").html("<div class='row text-center'><h4><i class='fa fa-spinner fa-spin'></i></h4></div>");

        $.ajax({
            url: "./module/RPTITEM/data.php",
            type: 'post',
            data: {
                load: 'GetRowsShipping',
                item: item,
                loc: loc,
                atYear: atYear
            },
            success: function (data) {
                $("#modalDetailHead").text("ข้อมูล [" + item + "] ระหว่างส่ง ");
                $("#tblModal").html(data);
                $('#tblModal').DataTable({
                    "scrollX": true,
                    searching: true,
                    fixedHeader: true,
                    retrieve: true,
                    "pageLength": 999999999,
                    'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'>f>" +
                            "<'row'<'col-md-12'tr>>" +
                            "<'row'<'col-md-5'><'col-sm-7'>>",
                    buttons: [
                        {
                            extend: 'print',
                            text: "<i class='fa fa-print'></i>&nbsp;Print",
                            title: ''
                        },
                        {
                            extend: 'excel',
                            text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                            title: ''
                        },
                    ]
                });
            },
            error: function (xhr, status, error) {
                $("#debug").html(xhr.responseText);
            },
            //            dataType: "json"
        });


    }
    function Shipped(thisid) {
        var datarow = thisid.split("!!")[1];
        var item = thisid.split("!!")[2];
        var loc = thisid.split("!!")[3];
        $("#modalDetail").modal("show");
        $("#modalDetailHead").html("<div class='row text-center'><h4><i class='fa fa-spinner fa-spin'></i></h4></div>");

        $.ajax({
            url: "./module/RPTITEM/data.php",
            type: 'post',
            data: {
                load: 'GetRowsShipped',
                item: item,
                loc: loc
            },
            success: function (data) {
                $("#modalDetailHead").text("ข้อมูล [" + item + "] ส่งแล้ว ");
                $("#tbodyModal").html(data);
                $('#tblModal').DataTable({
                    "scrollX": true,
                    searching: true,
                    fixedHeader: true,
                    retrieve: true,
                    "pageLength": 999999999,
                    'dom': "<'row'<'col-md-5'B><'col-md-7 text-right col-flt-page'f>>" +
                            "<'row'<'col-md-12'tr>>" +
                            "<'row'<'col-md-5'><'col-sm-7'>>",
                    buttons: [
                        {
                            extend: 'print',
                            text: "<i class='fa fa-print'></i>&nbsp;Print",
                            title: ''
                        },
                        {
                            extend: 'excel',
                            text: "<i class='fa fa-file-excel'></i>&nbsp;Excel",
                            title: ''
                        },
                    ]
                });
            },
            error: function (xhr, status, error) {
                $("#debug").html(xhr.responseText);
            },
            //            dataType: "json"
        });


    }
//$("#radSize1").click();
//    function RadioClick(thisid) {
//        var thisval = $("#" + thisid).val();
//
//        if (thisval == "1") {
//            $("#selSize").removeAttr("disabled");
//            $("#txtSize").attr("disabled", true);
//        } else {
//            $("#txtSize").removeAttr("disabled");
//            $("#selSize").attr("disabled", true);
//        }
//    }
</script>
